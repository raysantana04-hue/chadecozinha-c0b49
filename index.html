<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Ch√° de Cozinha da L√≠gia ü§ç</title>

<style>
    body { font-family: Arial; background:#f5f1ea; margin:0; text-align:center; }
    header { background:black; color:white; padding:30px; }
    h1 { margin:0; }
    .container { padding:20px; display: flex; flex-wrap: wrap; justify-content: center; }
    .item { 
        background:white; margin:10px; padding:15px; width:280px; 
        border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); 
        transition: transform 0.2s;
    }
    .item:hover { transform: scale(1.02); }
    .item img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
    button { background:black; color:white; border:none; padding:10px; border-radius:5px; cursor:pointer; width: 100%; }
    button:hover { background:#444; }
    .reservado-estilo { background:#ccc !important; cursor: not-allowed; }
    input { padding:8px; margin-top:5px; width:90%; border: 1px solid #ddd; border-radius: 4px; }
    .link-sugestao { display: block; margin: 10px 0; font-size: 12px; color: #0066ff; text-decoration: none; }
</style>
</head>

<body>

<header>
    <h1>Ch√° de Cozinha da L√≠gia ü§ç</h1>
    <p>21 de Fevereiro de 2026</p>
    <p>Escolha seu presente com carinho ‚ú®</p>
</header>

<div class="container" id="lista">Carregando presentes...</div>

<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

<script>
  // Suas configura√ß√µes do Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyCm9DgExRWhYNryZMMrO00Ya9g0lfNHilU",
    authDomain: "chadecozinha-c0b49-27555.firebaseapp.com",
    databaseURL: "https://chadecozinha-c0b49-27555-default-rtdb.firebaseio.com",
    projectId: "chadecozinha-c0b49-27555",
    storageBucket: "chadecozinha-c0b49-27555.firebasestorage.app",
    messagingSenderId: "210066909829",
    appId: "1:210066909829:web:bb6958ff15e1a18e3017ec",
    measurementId: "G-PXVHMW524J"
  };

  // Inicializa o Firebase no padr√£o Compat (v8)
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // Fun√ß√£o para carregar os 54 itens do Realtime Database em tempo real
  function carregar() {
    database.ref('presentes').on('value', (snapshot) => {
      const presentesData = snapshot.val();
      let html = "";

      if (!presentesData) {
        document.getElementById("lista").innerHTML = "<p>Nenhum presente encontrado. Verifique a importa√ß√£o do JSON.</p>";
        return;
      }

      // Garante que o objeto do Firebase seja tratado como lista para o loop
      // O seu JSON tem campos como nome, imagem e link
      presentesData.forEach((item, i) => {
        const isReservado = item.reservado;
        const textoBotao = isReservado ? `Reservado por ${item.pessoa}` : "Escolher Presente";
        const classeBotao = isReservado ? "reservado-estilo" : "";

        html += `
          <div class="item">
            <img src="${item.imagem}" alt="${item.nome}">
            <h3>${item.nome}</h3>
            <a href="${item.link}" target="_blank" class="link-sugestao">Sugest√£o de Produto</a>
            
            ${!isReservado ? `
              <input id="nome${i}" placeholder="Seu nome">
              <br><br>
              <button onclick="reservar(${i})" id="btn${i}">
                ${textoBotao}
              </button>
            ` : `
              <button class="reservado-estilo" disabled>
                ${textoBotao}
              </button>
            `}
          </div>
        `;
      });

      document.getElementById("lista").innerHTML = html;
    });
  }

  // Fun√ß√£o para salvar a reserva no banco de dados
  function reservar(i) {
    const nomeConvidado = document.getElementById("nome" + i).value;

    if (nomeConvidado.trim() === "") {
      alert("Por favor, digite seu nome para reservar.");
      return;
    }

    // Atualiza o item espec√≠fico no Firebase Realtime Database
    database.ref('presentes/' + i).update({
      reservado: true,
      pessoa: nomeConvidado
    })
    .then(() => {
      alert("Obrigado! Presente reservado com sucesso. ‚ù§Ô∏è");
    })
    .catch((error) => {
      console.error("Erro ao reservar:", error);
      alert("Houve um erro. Verifique se as Regras do Banco est√£o abertas.");
    });
  }

  // Inicia o carregamento
  carregar();
</script>

</body>
</html>
